{"type":"operationStart","subtype":"profile","data":{"_id":"a5KcYcyLWCzOP1uQ","timestamp":"2023-08-17T07:27:16.539Z","state":"queued","mode":"standard","creationDate":"2023-08-17T07:27:16.543Z","modificationDate":"2023-08-17T07:27:16.543Z","shortid":"UvP1SAn","$entitySet":"profiles"},"doDiffs":false,"timestamp":1692257236542,"id":"z1htyjxtoszjvb9","previousOperationId":null,"operationId":"umvextig3w43zqn"}
{"type":"log","level":"info","message":"Render request 6 queued for execution and waiting for available worker","previousOperationId":"umvextig3w43zqn","timestamp":1692257236542,"id":"puawfvage0qy89o"}
{"type":"operationStart","subtype":"render","name":"iLotusLand report","previousOperationId":"umvextig3w43zqn","timestamp":1692257236563,"id":"hdvwc545exuqbrx","previousEventId":"z1htyjxtoszjvb9","operationId":"gxq3ttmlk2bcosg"}
{"type":"log","timestamp":1692257236564,"level":"info","message":"Starting rendering request 6","meta":{"rootId":"khppi9zuhnipsgc","id":"khppi9zuhnipsgc"},"id":"ymopjzejhd6ck4o","previousOperationId":"gxq3ttmlk2bcosg"}
{"type":"log","timestamp":1692257236566,"level":"info","message":"Rendering template { name: iLotusLand report, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"khppi9zuhnipsgc","id":"khppi9zuhnipsgc"},"id":"cxf9rn344i0jyhp","previousOperationId":"gxq3ttmlk2bcosg"}
{"type":"log","timestamp":1692257236567,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"khppi9zuhnipsgc","id":"khppi9zuhnipsgc"},"id":"vrbsw5t55i448xe","previousOperationId":"gxq3ttmlk2bcosg"}
{"type":"log","timestamp":1692257236576,"level":"debug","message":"Executing script ill-script (beforeRender)","meta":{"rootId":"khppi9zuhnipsgc","id":"khppi9zuhnipsgc"},"id":"euuy1pjspeymbhz","previousOperationId":"gxq3ttmlk2bcosg"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1692257238318,"id":"kv49c8e2t66m4kw","previousEventId":"hdvwc545exuqbrx","operationId":"cajyt5h1tv9th2x","previousOperationId":"gxq3ttmlk2bcosg"}
{"type":"operationStart","subtype":"script","name":"scripts ill-script","previousOperationId":"cajyt5h1tv9th2x","timestamp":1692257238318,"id":"ja0k5rgsghmsz67","previousEventId":"kv49c8e2t66m4kw","operationId":"jkx9ehq6xsu61hj"}
{"type":"log","timestamp":1692257238318,"level":"debug","message":"(console:log) Before render.....","meta":{"userLevel":true,"rootId":"khppi9zuhnipsgc","id":"khppi9zuhnipsgc"},"id":"t14z3hf0qq58bqd","previousOperationId":"jkx9ehq6xsu61hj"}
{"type":"log","timestamp":1692257239047,"level":"warn","message":"Error when processing render request 6\n(because) error when evaluating custom script /ill-script\nCannot access 'data' before initialization\n\n(sandbox.js line 26:45)\n\n  24 |             result.on('end', () => {\n  25 |                 try {\n> 26 |                     console.log(\"strstrstr\",data)\n     |                                             ^\n  27 |                     const data = JSON.parse(data).value;\n  28 |                     resolve(data);\n  29 |                 } catch (error) {\n\n\nReferenceError: Cannot access 'data' before initialization\n    at IncomingMessage.<anonymous> (sandbox.js:26:45)\n    at IncomingMessage.emit (node:events:525:35)\n    at IncomingMessage.emit (node:domain:552:15)\n    at endReadableNT (node:internal/streams/readable:1359:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","meta":{"rootId":"khppi9zuhnipsgc","id":"khppi9zuhnipsgc"},"id":"mkq1snb0kp0pnuw","previousOperationId":"jkx9ehq6xsu61hj"}
{"type":"log","timestamp":1692257239047,"level":"warn","message":"Rendering request 6 finished with error in 2508 ms","meta":{"rootId":"khppi9zuhnipsgc","id":"khppi9zuhnipsgc"},"id":"il393h6f23a4onu","previousOperationId":"jkx9ehq6xsu61hj"}
{"type":"error","timestamp":1692257239080,"statusCode":400,"weak":true,"lineNumber":26,"decoratedSuffix":"\n\n(sandbox.js line 26:45)\n\n  24 |             result.on('end', () => {\n  25 |                 try {\n> 26 |                     console.log(\"strstrstr\",data)\n     |                                             ^\n  27 |                     const data = JSON.parse(data).value;\n  28 |                     resolve(data);\n  29 |                 } catch (error) {\n\n","entity":{"shortid":"vivaZZXxUu","name":"ill-script","content":"// server side script fetching remote data and preparing report data source\nconst https = require('https');\n\nconst END_POINT = 'https://demo-api.ilotusland.asia/station-auto/last-log';\nconst CUSTOM_HEADER = {\n    'Authorization': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDE5MGI3ZWZjMzgzMDAwMWJmMTAxNWUiLCJmaXJzdE5hbWUiOiJNaW5oIiwibGFzdE5hbWUiOiLEkOG7lyIsImlzQWRtaW4iOnRydWUsImlzQWN0aXZlIjpmYWxzZSwiaXNPd25lciI6dHJ1ZSwib3JnYW5pemF0aW9uIjp7Il9pZCI6IjVlZWY4MDExOWQ0ZjQ1MDAxMWMzMGQ1OSIsIm5hbWUiOiJpTG90dXNMYW5kIFZpZXQgTmFtIEpTQy4ifSwiaWF0IjoxNjkwOTU3OTk0fQ.x2abIiIwQf8tXlqYIUZ2EUdw9sIwwt1TG7ZE-hxs7Eo',\n};\n\nfunction fetchData() {\n    return new Promise((resolve, reject) => {\n        const options = {\n            headers: CUSTOM_HEADER\n        };\n\n        https.get(END_POINT, options, (result) => {\n            var data = '';\n\n            result.on('data', (chunk) => {\n                data +=chunk; // Convert the received data chunk to a string\n            });\n\n            result.on('error', reject);\n\n            result.on('end', () => {\n                try {\n                    console.log(\"strstrstr\",data)\n                    const data = JSON.parse(data).value;\n                    resolve(data);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        });\n\n    });\n}\n\nconst prepareData = async() => {\n    const data = await fetchData()\n    let stations = data.data\n    stations = stations.map(station => {\n        return {\n            name: station.name,\n            data: station.lastlog.measuringLogs\n        }\n    })\n    console.log(stations,'stationsstations')\n    return stations\n}\n\n\nasync function beforeRender(req, res) {\n    console.log(\"Before render.....\")\n    req.stations = await prepareData()\n}"},"property":"content","logged":true,"previousOperationId":"jkx9ehq6xsu61hj","id":"49jhmf8fxu20o03","stack":"ReferenceError: Cannot access 'data' before initialization\n    at IncomingMessage.<anonymous> (sandbox.js:26:45)\n    at IncomingMessage.emit (node:events:525:35)\n    at IncomingMessage.emit (node:domain:552:15)\n    at endReadableNT (node:internal/streams/readable:1359:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","message":"Error when evaluating custom script /ill-script\nCannot access 'data' before initialization\n\n(sandbox.js line 26:45)\n\n  24 |             result.on('end', () => {\n  25 |                 try {\n> 26 |                     console.log(\"strstrstr\",data)\n     |                                             ^\n  27 |                     const data = JSON.parse(data).value;\n  28 |                     resolve(data);\n  29 |                 } catch (error) {\n\n"}
