{"type":"operationStart","subtype":"profile","data":{"_id":"ilypg7fCSxZRB6Xq","timestamp":"2023-08-17T07:37:12.304Z","state":"queued","mode":"standard","creationDate":"2023-08-17T07:37:12.338Z","modificationDate":"2023-08-17T07:37:12.338Z","shortid":"POg_sg9","$entitySet":"profiles"},"doDiffs":false,"timestamp":1692257832337,"id":"7urc5zq85rbces2","previousOperationId":null,"operationId":"klapbnqu86drnrv"}
{"type":"log","level":"info","message":"Render request 11 queued for execution and waiting for available worker","previousOperationId":"klapbnqu86drnrv","timestamp":1692257832337,"id":"hj7coq4o2tu5nrb"}
{"type":"operationStart","subtype":"render","name":"iLotusLand report","previousOperationId":"klapbnqu86drnrv","timestamp":1692257832365,"id":"01buwf0mrl74ci1","previousEventId":"7urc5zq85rbces2","operationId":"tqdglxyhw9ih214"}
{"type":"log","timestamp":1692257832374,"level":"info","message":"Starting rendering request 11","meta":{"rootId":"1dvus95l2bn01q1","id":"1dvus95l2bn01q1"},"id":"rpmvi1uygw9i36a","previousOperationId":"tqdglxyhw9ih214"}
{"type":"log","timestamp":1692257832376,"level":"info","message":"Rendering template { name: iLotusLand report, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"1dvus95l2bn01q1","id":"1dvus95l2bn01q1"},"id":"c4la6zjsczcrpbc","previousOperationId":"tqdglxyhw9ih214"}
{"type":"log","timestamp":1692257832379,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"1dvus95l2bn01q1","id":"1dvus95l2bn01q1"},"id":"3umskdkoqmhpy4e","previousOperationId":"tqdglxyhw9ih214"}
{"type":"log","timestamp":1692257832446,"level":"debug","message":"Executing script ill-script (beforeRender)","meta":{"rootId":"1dvus95l2bn01q1","id":"1dvus95l2bn01q1"},"id":"8n7q982qkj2fbzx","previousOperationId":"tqdglxyhw9ih214"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1692257832724,"id":"3k2r3rqkr9mvypo","previousEventId":"01buwf0mrl74ci1","operationId":"z20u7rwea7vk258","previousOperationId":"tqdglxyhw9ih214"}
{"type":"operationStart","subtype":"script","name":"scripts ill-script","previousOperationId":"z20u7rwea7vk258","timestamp":1692257832724,"id":"wvx7bjatj9fy8yi","previousEventId":"3k2r3rqkr9mvypo","operationId":"8s9u11eaurjpuf2"}
{"type":"log","timestamp":1692257832725,"level":"debug","message":"(console:log) Before render.....","meta":{"userLevel":true,"rootId":"1dvus95l2bn01q1","id":"1dvus95l2bn01q1"},"id":"71wr41zbo4q3z5o","previousOperationId":"8s9u11eaurjpuf2"}
{"type":"log","timestamp":1692257835014,"level":"debug","message":"(console:log) HEllo station [object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object]","meta":{"userLevel":true,"rootId":"1dvus95l2bn01q1","id":"1dvus95l2bn01q1"},"id":"u9gzbmpvv3pbqlr","previousOperationId":"8s9u11eaurjpuf2"}
{"type":"log","timestamp":1692257835021,"level":"warn","message":"Error when processing render request 11\n(because) error when evaluating custom script /ill-script\nCannot read properties of undefined (reading 'measuringLogs')\n\n(sandbox.js line 46:35)\n\n  44 |         return {\n  45 |             name: station.name,\n> 46 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  47 |         }\n  48 |     })\n  49 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 43:25)\n\n  41 |     let stations = data.data\n  42 |     console.log(\"HEllo station \"+stations)\n> 43 |     stations = stations.map(station => {\n     |                         ^\n  44 |         return {\n  45 |             name: station.name,\n  46 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 56:20)\n\n  54 | async function beforeRender(req, res) {\n  55 |     console.log(\"Before render.....\")\n> 56 |     req.stations = await prepareData()\n     |                    ^\n  57 | }\n\n\nTypeError: Cannot read properties of undefined (reading 'measuringLogs')\n    at sandbox.js:46:35\n    at Array.map (<anonymous>)\n    at prepareData (sandbox.js:43:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Object.beforeRender (sandbox.js:56:20)\n    at async executionFn (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:67:11)\n    at async run (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:152:24)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:182:14)\n    at async executeScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:122:12)\n    at async Scripts._runScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/worker.js:140:30)","meta":{"rootId":"1dvus95l2bn01q1","id":"1dvus95l2bn01q1"},"id":"kb7vyw9x7021u9s","previousOperationId":"8s9u11eaurjpuf2"}
{"type":"log","timestamp":1692257835021,"level":"warn","message":"Rendering request 11 finished with error in 2718 ms","meta":{"rootId":"1dvus95l2bn01q1","id":"1dvus95l2bn01q1"},"id":"4kbyscgzuv6e57s","previousOperationId":"8s9u11eaurjpuf2"}
{"type":"error","timestamp":1692257835155,"statusCode":400,"weak":true,"lineNumber":46,"decoratedSuffix":"\n\n(sandbox.js line 46:35)\n\n  44 |         return {\n  45 |             name: station.name,\n> 46 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  47 |         }\n  48 |     })\n  49 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 43:25)\n\n  41 |     let stations = data.data\n  42 |     console.log(\"HEllo station \"+stations)\n> 43 |     stations = stations.map(station => {\n     |                         ^\n  44 |         return {\n  45 |             name: station.name,\n  46 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 56:20)\n\n  54 | async function beforeRender(req, res) {\n  55 |     console.log(\"Before render.....\")\n> 56 |     req.stations = await prepareData()\n     |                    ^\n  57 | }\n\n","entity":{"shortid":"vivaZZXxUu","name":"ill-script","content":"// server side script fetching remote data and preparing report data source\nconst https = require('https');\n\nconst END_POINT = 'https://demo-api.ilotusland.asia/station-auto/last-log';\nconst CUSTOM_HEADER = {\n    'Authorization': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDE5MGI3ZWZjMzgzMDAwMWJmMTAxNWUiLCJmaXJzdE5hbWUiOiJNaW5oIiwibGFzdE5hbWUiOiLEkOG7lyIsImlzQWRtaW4iOnRydWUsImlzQWN0aXZlIjpmYWxzZSwiaXNPd25lciI6dHJ1ZSwib3JnYW5pemF0aW9uIjp7Il9pZCI6IjVlZWY4MDExOWQ0ZjQ1MDAxMWMzMGQ1OSIsIm5hbWUiOiJpTG90dXNMYW5kIFZpZXQgTmFtIEpTQy4ifSwiaWF0IjoxNjkwOTU3OTk0fQ.x2abIiIwQf8tXlqYIUZ2EUdw9sIwwt1TG7ZE-hxs7Eo',\n};\n\nfunction fetchData() {\n    return new Promise((resolve, reject) => {\n        const options = {\n            headers: CUSTOM_HEADER\n        };\n\n        https.get(END_POINT, options, (result) => {\n            let data = '';\n\n            result.on('data', (chunk) => {\n                data +=chunk; // Convert the received data chunk to a string\n            });\n\n            result.on('error', reject);\n\n            result.on('end', () => {\n                try {\n                    // console.log(\"strstrstr\",data)\n                    const result = JSON.parse(data);\n                    resolve(result);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        });\n\n    });\n}\n\nconst prepareData = async() => {\n    const data = await fetchData()\n    \n    let stations = data.data\n    console.log(\"HEllo station \"+stations)\n    stations = stations.map(station => {\n        return {\n            name: station.name,\n            data: station.lastlog.measuringLogs\n        }\n    })\n    console.log(stations,'stationsstations')\n    return stations\n}\n\n\nasync function beforeRender(req, res) {\n    console.log(\"Before render.....\")\n    req.stations = await prepareData()\n}"},"property":"content","logged":true,"previousOperationId":"8s9u11eaurjpuf2","id":"0pelnim6fg7u837","stack":"TypeError: Cannot read properties of undefined (reading 'measuringLogs')\n    at sandbox.js:46:35\n    at Array.map (<anonymous>)\n    at prepareData (sandbox.js:43:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Object.beforeRender (sandbox.js:56:20)\n    at async executionFn (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:67:11)\n    at async run (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:152:24)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:182:14)\n    at async executeScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:122:12)\n    at async Scripts._runScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/worker.js:140:30)","message":"Error when evaluating custom script /ill-script\nCannot read properties of undefined (reading 'measuringLogs')\n\n(sandbox.js line 46:35)\n\n  44 |         return {\n  45 |             name: station.name,\n> 46 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  47 |         }\n  48 |     })\n  49 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 43:25)\n\n  41 |     let stations = data.data\n  42 |     console.log(\"HEllo station \"+stations)\n> 43 |     stations = stations.map(station => {\n     |                         ^\n  44 |         return {\n  45 |             name: station.name,\n  46 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 56:20)\n\n  54 | async function beforeRender(req, res) {\n  55 |     console.log(\"Before render.....\")\n> 56 |     req.stations = await prepareData()\n     |                    ^\n  57 | }\n\n"}
