{"type":"operationStart","subtype":"profile","data":{"_id":"lis3hpDe8gsHYdq4","timestamp":"2023-08-17T07:22:14.048Z","state":"queued","mode":"standard","creationDate":"2023-08-17T07:22:14.060Z","modificationDate":"2023-08-17T07:22:14.060Z","shortid":"5UZr4_F","$entitySet":"profiles"},"doDiffs":false,"timestamp":1692256934056,"id":"cs0wvry2x4wztoz","previousOperationId":null,"operationId":"1rq67pduy9ciruo"}
{"type":"log","level":"info","message":"Render request 2 queued for execution and waiting for available worker","previousOperationId":"1rq67pduy9ciruo","timestamp":1692256934057,"id":"rt9j4u7talvep05"}
{"type":"operationStart","subtype":"render","name":"iLotusLand report","previousOperationId":"1rq67pduy9ciruo","timestamp":1692256934083,"id":"liysfnyzotd1s46","previousEventId":"cs0wvry2x4wztoz","operationId":"l05jbg4pj4w0r98"}
{"type":"log","timestamp":1692256934084,"level":"info","message":"Starting rendering request 2","meta":{"rootId":"cjb5j1k1w3ikhot","id":"cjb5j1k1w3ikhot"},"id":"qabi5tkdqnuitu4","previousOperationId":"l05jbg4pj4w0r98"}
{"type":"log","timestamp":1692256934107,"level":"info","message":"Rendering template { name: iLotusLand report, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"cjb5j1k1w3ikhot","id":"cjb5j1k1w3ikhot"},"id":"mnjhpl3lhkxjhl2","previousOperationId":"l05jbg4pj4w0r98"}
{"type":"log","timestamp":1692256934108,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"cjb5j1k1w3ikhot","id":"cjb5j1k1w3ikhot"},"id":"9prh6tpgwaj2yl7","previousOperationId":"l05jbg4pj4w0r98"}
{"type":"log","timestamp":1692256934133,"level":"debug","message":"Executing script ill-script (beforeRender)","meta":{"rootId":"cjb5j1k1w3ikhot","id":"cjb5j1k1w3ikhot"},"id":"n18j0dgw16hxsdj","previousOperationId":"l05jbg4pj4w0r98"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1692256935531,"id":"zv4oeovqbwj1mfc","previousEventId":"liysfnyzotd1s46","operationId":"dr3vododpaeaumb","previousOperationId":"l05jbg4pj4w0r98"}
{"type":"operationStart","subtype":"script","name":"scripts ill-script","previousOperationId":"dr3vododpaeaumb","timestamp":1692256935532,"id":"f76pc0jyoxc1vbm","previousEventId":"zv4oeovqbwj1mfc","operationId":"n1x7p4wcmmxc67s"}
{"type":"log","timestamp":1692256935532,"level":"debug","message":"(console:log) Before render.....","meta":{"userLevel":true,"rootId":"cjb5j1k1w3ikhot","id":"cjb5j1k1w3ikhot"},"id":"88cb25qe069xl05","previousOperationId":"n1x7p4wcmmxc67s"}
{"type":"log","timestamp":1692256936482,"level":"warn","message":"Error when processing render request 2\n(because) error when evaluating custom script /ill-script\nUnexpected token a in JSON at position 1\n\n(sandbox.js line 26:39)\n\n  24 |             result.on('end', () => {\n  25 |                 try {\n> 26 |                     const data = JSON.parse(str).value;\n     |                                       ^\n  27 |                     resolve(data);\n  28 |                 } catch (error) {\n  29 |                     reject(error);\n\n\nSyntaxError: Unexpected token a in JSON at position 1\n    at JSON.parse (<anonymous>)\n    at IncomingMessage.<anonymous> (sandbox.js:26:39)\n    at IncomingMessage.emit (node:events:525:35)\n    at IncomingMessage.emit (node:domain:552:15)\n    at endReadableNT (node:internal/streams/readable:1359:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","meta":{"rootId":"cjb5j1k1w3ikhot","id":"cjb5j1k1w3ikhot"},"id":"51akw2up7alq1zd","previousOperationId":"n1x7p4wcmmxc67s"}
{"type":"log","timestamp":1692256936482,"level":"warn","message":"Rendering request 2 finished with error in 2434 ms","meta":{"rootId":"cjb5j1k1w3ikhot","id":"cjb5j1k1w3ikhot"},"id":"tb8j5ashsw8cakw","previousOperationId":"n1x7p4wcmmxc67s"}
{"type":"error","timestamp":1692256936612,"statusCode":400,"weak":true,"decoratedSuffix":"\n\n(sandbox.js line 26:39)\n\n  24 |             result.on('end', () => {\n  25 |                 try {\n> 26 |                     const data = JSON.parse(str).value;\n     |                                       ^\n  27 |                     resolve(data);\n  28 |                 } catch (error) {\n  29 |                     reject(error);\n\n","entity":{"shortid":"vivaZZXxUu","name":"ill-script","content":"// server side script fetching remote data and preparing report data source\nconst https = require('https');\n\nconst END_POINT = 'https://demo-api.ilotusland.asia/station-auto/last-log';\nconst CUSTOM_HEADER = {\n    'Authorization': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDE5MGI3ZWZjMzgzMDAwMWJmMTAxNWUiLCJmaXJzdE5hbWUiOiJNaW5oIiwibGFzdE5hbWUiOiLEkOG7lyIsImlzQWRtaW4iOnRydWUsImlzQWN0aXZlIjpmYWxzZSwiaXNPd25lciI6dHJ1ZSwib3JnYW5pemF0aW9uIjp7Il9pZCI6IjVlZWY4MDExOWQ0ZjQ1MDAxMWMzMGQ1OSIsIm5hbWUiOiJpTG90dXNMYW5kIFZpZXQgTmFtIEpTQy4ifSwiaWF0IjoxNjkwOTU3OTk0fQ.x2abIiIwQf8tXlqYIUZ2EUdw9sIwwt1TG7ZE-hxs7Eo',\n};\n\nfunction fetchData() {\n    return new Promise((resolve, reject) => {\n        const options = {\n            headers: CUSTOM_HEADER\n        };\n\n        https.get(END_POINT, options, (result) => {\n            var str = '';\n\n            result.on('data', (b) => {\n                str = b.toString(); // Convert the received data chunk to a string\n            });\n\n            result.on('error', reject);\n\n            result.on('end', () => {\n                try {\n                    const data = JSON.parse(str).value;\n                    resolve(data);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        });\n\n    });\n}\n\nconst prepareData = async() => {\n    const data = await fetchData()\n    let stations = data.data\n    stations = stations.map(station => {\n        return {\n            name: station.name,\n            data: station.lastlog.measuringLogs\n        }\n    })\n    console.log(stations,'stationsstations')\n    return stations\n}\n\n\nasync function beforeRender(req, res) {\n    console.log(\"Before render.....\")\n    req.stations = await prepareData()\n}"},"property":"content","logged":true,"previousOperationId":"n1x7p4wcmmxc67s","id":"j1usnu09v6qch3f","stack":"SyntaxError: Unexpected token a in JSON at position 1\n    at JSON.parse (<anonymous>)\n    at IncomingMessage.<anonymous> (sandbox.js:26:39)\n    at IncomingMessage.emit (node:events:525:35)\n    at IncomingMessage.emit (node:domain:552:15)\n    at endReadableNT (node:internal/streams/readable:1359:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","message":"Error when evaluating custom script /ill-script\nUnexpected token a in JSON at position 1\n\n(sandbox.js line 26:39)\n\n  24 |             result.on('end', () => {\n  25 |                 try {\n> 26 |                     const data = JSON.parse(str).value;\n     |                                       ^\n  27 |                     resolve(data);\n  28 |                 } catch (error) {\n  29 |                     reject(error);\n\n"}
