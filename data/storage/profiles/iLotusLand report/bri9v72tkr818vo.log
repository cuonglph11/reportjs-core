{"type":"operationStart","subtype":"profile","data":{"_id":"2PPwgqr2VVWkpSdh","timestamp":"2023-08-17T07:29:42.478Z","state":"queued","mode":"standard","creationDate":"2023-08-17T07:29:42.484Z","modificationDate":"2023-08-17T07:29:42.484Z","shortid":"QXyxzpb","$entitySet":"profiles"},"doDiffs":false,"timestamp":1692257382482,"id":"3ytpswf5bec73cd","previousOperationId":null,"operationId":"k8lanu8wtxkd8tm"}
{"type":"log","level":"info","message":"Render request 8 queued for execution and waiting for available worker","previousOperationId":"k8lanu8wtxkd8tm","timestamp":1692257382483,"id":"h1sq4tee737xht8"}
{"type":"operationStart","subtype":"render","name":"iLotusLand report","previousOperationId":"k8lanu8wtxkd8tm","timestamp":1692257382505,"id":"8e5fcp56fl1ragd","previousEventId":"3ytpswf5bec73cd","operationId":"i42gdo7d4iww4ro"}
{"type":"log","timestamp":1692257382505,"level":"info","message":"Starting rendering request 8","meta":{"rootId":"bri9v72tkr818vo","id":"bri9v72tkr818vo"},"id":"n5wu3kqv7iro7ju","previousOperationId":"i42gdo7d4iww4ro"}
{"type":"log","timestamp":1692257382506,"level":"info","message":"Rendering template { name: iLotusLand report, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"bri9v72tkr818vo","id":"bri9v72tkr818vo"},"id":"3k1y558heq4rbm2","previousOperationId":"i42gdo7d4iww4ro"}
{"type":"log","timestamp":1692257382506,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"bri9v72tkr818vo","id":"bri9v72tkr818vo"},"id":"sujv45rcnssp1qr","previousOperationId":"i42gdo7d4iww4ro"}
{"type":"log","timestamp":1692257382514,"level":"debug","message":"Executing script ill-script (beforeRender)","meta":{"rootId":"bri9v72tkr818vo","id":"bri9v72tkr818vo"},"id":"w84nhd9z8kphsd6","previousOperationId":"i42gdo7d4iww4ro"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1692257382563,"id":"ng4mgnmq66bnl3w","previousEventId":"8e5fcp56fl1ragd","operationId":"p6lmrt9d6ztv232","previousOperationId":"i42gdo7d4iww4ro"}
{"type":"operationStart","subtype":"script","name":"scripts ill-script","previousOperationId":"p6lmrt9d6ztv232","timestamp":1692257382563,"id":"zfsreh15lvvkxxj","previousEventId":"ng4mgnmq66bnl3w","operationId":"uvriu04hatfux0a"}
{"type":"log","timestamp":1692257382563,"level":"debug","message":"(console:log) Before render.....","meta":{"userLevel":true,"rootId":"bri9v72tkr818vo","id":"bri9v72tkr818vo"},"id":"pyqv62h8uok68mf","previousOperationId":"uvriu04hatfux0a"}
{"type":"log","timestamp":1692257383339,"level":"debug","message":"(console:log) HEllo station [object Object]","meta":{"userLevel":true,"rootId":"bri9v72tkr818vo","id":"bri9v72tkr818vo"},"id":"bxjbq82liinlhzl","previousOperationId":"uvriu04hatfux0a"}
{"type":"log","timestamp":1692257383340,"level":"warn","message":"Error when processing render request 8\n(because) error when evaluating custom script /ill-script\nCannot read properties of undefined (reading 'measuringLogs')\n\n(sandbox.js line 45:35)\n\n  43 |         return {\n  44 |             name: station.name,\n> 45 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  46 |         }\n  47 |     })\n  48 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 42:25)\n\n  40 |     console.log(\"HEllo station \"+data)\n  41 |     let stations = data.data\n> 42 |     stations = stations.map(station => {\n     |                         ^\n  43 |         return {\n  44 |             name: station.name,\n  45 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 55:20)\n\n  53 | async function beforeRender(req, res) {\n  54 |     console.log(\"Before render.....\")\n> 55 |     req.stations = await prepareData()\n     |                    ^\n  56 | }\n\n\nTypeError: Cannot read properties of undefined (reading 'measuringLogs')\n    at sandbox.js:45:35\n    at Array.map (<anonymous>)\n    at prepareData (sandbox.js:42:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Object.beforeRender (sandbox.js:55:20)\n    at async executionFn (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:67:11)\n    at async run (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:152:24)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:182:14)\n    at async executeScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:122:12)\n    at async Scripts._runScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/worker.js:140:30)","meta":{"rootId":"bri9v72tkr818vo","id":"bri9v72tkr818vo"},"id":"hf3eepeqv5esgip","previousOperationId":"uvriu04hatfux0a"}
{"type":"log","timestamp":1692257383341,"level":"warn","message":"Rendering request 8 finished with error in 863 ms","meta":{"rootId":"bri9v72tkr818vo","id":"bri9v72tkr818vo"},"id":"axq3zba3i354etm","previousOperationId":"uvriu04hatfux0a"}
{"type":"error","timestamp":1692257383357,"statusCode":400,"weak":true,"lineNumber":45,"decoratedSuffix":"\n\n(sandbox.js line 45:35)\n\n  43 |         return {\n  44 |             name: station.name,\n> 45 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  46 |         }\n  47 |     })\n  48 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 42:25)\n\n  40 |     console.log(\"HEllo station \"+data)\n  41 |     let stations = data.data\n> 42 |     stations = stations.map(station => {\n     |                         ^\n  43 |         return {\n  44 |             name: station.name,\n  45 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 55:20)\n\n  53 | async function beforeRender(req, res) {\n  54 |     console.log(\"Before render.....\")\n> 55 |     req.stations = await prepareData()\n     |                    ^\n  56 | }\n\n","entity":{"shortid":"vivaZZXxUu","name":"ill-script","content":"// server side script fetching remote data and preparing report data source\nconst https = require('https');\n\nconst END_POINT = 'https://demo-api.ilotusland.asia/station-auto/last-log';\nconst CUSTOM_HEADER = {\n    'Authorization': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDE5MGI3ZWZjMzgzMDAwMWJmMTAxNWUiLCJmaXJzdE5hbWUiOiJNaW5oIiwibGFzdE5hbWUiOiLEkOG7lyIsImlzQWRtaW4iOnRydWUsImlzQWN0aXZlIjpmYWxzZSwiaXNPd25lciI6dHJ1ZSwib3JnYW5pemF0aW9uIjp7Il9pZCI6IjVlZWY4MDExOWQ0ZjQ1MDAxMWMzMGQ1OSIsIm5hbWUiOiJpTG90dXNMYW5kIFZpZXQgTmFtIEpTQy4ifSwiaWF0IjoxNjkwOTU3OTk0fQ.x2abIiIwQf8tXlqYIUZ2EUdw9sIwwt1TG7ZE-hxs7Eo',\n};\n\nfunction fetchData() {\n    return new Promise((resolve, reject) => {\n        const options = {\n            headers: CUSTOM_HEADER\n        };\n\n        https.get(END_POINT, options, (result) => {\n            let data = '';\n\n            result.on('data', (chunk) => {\n                data +=chunk; // Convert the received data chunk to a string\n            });\n\n            result.on('error', reject);\n\n            result.on('end', () => {\n                try {\n                    // console.log(\"strstrstr\",data)\n                    const result = JSON.parse(data);\n                    resolve(result);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        });\n\n    });\n}\n\nconst prepareData = async() => {\n    const data = await fetchData()\n    console.log(\"HEllo station \"+data)\n    let stations = data.data\n    stations = stations.map(station => {\n        return {\n            name: station.name,\n            data: station.lastlog.measuringLogs\n        }\n    })\n    console.log(stations,'stationsstations')\n    return stations\n}\n\n\nasync function beforeRender(req, res) {\n    console.log(\"Before render.....\")\n    req.stations = await prepareData()\n}"},"property":"content","logged":true,"previousOperationId":"uvriu04hatfux0a","id":"4envbz3sdcblq86","stack":"TypeError: Cannot read properties of undefined (reading 'measuringLogs')\n    at sandbox.js:45:35\n    at Array.map (<anonymous>)\n    at prepareData (sandbox.js:42:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Object.beforeRender (sandbox.js:55:20)\n    at async executionFn (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:67:11)\n    at async run (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:152:24)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:182:14)\n    at async executeScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:122:12)\n    at async Scripts._runScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/worker.js:140:30)","message":"Error when evaluating custom script /ill-script\nCannot read properties of undefined (reading 'measuringLogs')\n\n(sandbox.js line 45:35)\n\n  43 |         return {\n  44 |             name: station.name,\n> 45 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  46 |         }\n  47 |     })\n  48 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 42:25)\n\n  40 |     console.log(\"HEllo station \"+data)\n  41 |     let stations = data.data\n> 42 |     stations = stations.map(station => {\n     |                         ^\n  43 |         return {\n  44 |             name: station.name,\n  45 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 55:20)\n\n  53 | async function beforeRender(req, res) {\n  54 |     console.log(\"Before render.....\")\n> 55 |     req.stations = await prepareData()\n     |                    ^\n  56 | }\n\n"}
