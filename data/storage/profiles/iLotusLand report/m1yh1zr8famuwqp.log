{"type":"operationStart","subtype":"profile","data":{"_id":"tPQ7dXmAWIzpZtEt","timestamp":"2023-08-17T07:23:34.467Z","state":"queued","mode":"standard","creationDate":"2023-08-17T07:23:34.470Z","modificationDate":"2023-08-17T07:23:34.470Z","shortid":"HmMKKDz","$entitySet":"profiles"},"doDiffs":false,"timestamp":1692257014468,"id":"53fm328dad5dkdr","previousOperationId":null,"operationId":"jks9ur2cm6r4ua4"}
{"type":"log","level":"info","message":"Render request 3 queued for execution and waiting for available worker","previousOperationId":"jks9ur2cm6r4ua4","timestamp":1692257014469,"id":"78i19dmo8vana9o"}
{"type":"operationStart","subtype":"render","name":"iLotusLand report","previousOperationId":"jks9ur2cm6r4ua4","timestamp":1692257014495,"id":"h3yefrcy5fxhl9g","previousEventId":"53fm328dad5dkdr","operationId":"8l8xc6v34r8cqes"}
{"type":"log","timestamp":1692257014495,"level":"info","message":"Starting rendering request 3","meta":{"rootId":"m1yh1zr8famuwqp","id":"m1yh1zr8famuwqp"},"id":"iyag58zcwl8l9rw","previousOperationId":"8l8xc6v34r8cqes"}
{"type":"log","timestamp":1692257014496,"level":"info","message":"Rendering template { name: iLotusLand report, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"m1yh1zr8famuwqp","id":"m1yh1zr8famuwqp"},"id":"o5npdn9b1y8kjks","previousOperationId":"8l8xc6v34r8cqes"}
{"type":"log","timestamp":1692257014496,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"m1yh1zr8famuwqp","id":"m1yh1zr8famuwqp"},"id":"iaqhffob17wrgde","previousOperationId":"8l8xc6v34r8cqes"}
{"type":"log","timestamp":1692257014505,"level":"debug","message":"Executing script ill-script (beforeRender)","meta":{"rootId":"m1yh1zr8famuwqp","id":"m1yh1zr8famuwqp"},"id":"kwqwfm1onhg8y5q","previousOperationId":"8l8xc6v34r8cqes"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1692257014780,"id":"s9aq1mkrnd4qp77","previousEventId":"h3yefrcy5fxhl9g","operationId":"cqmq9cx5bz0k03m","previousOperationId":"8l8xc6v34r8cqes"}
{"type":"operationStart","subtype":"script","name":"scripts ill-script","previousOperationId":"cqmq9cx5bz0k03m","timestamp":1692257014780,"id":"e1oigmtvt7jadjg","previousEventId":"s9aq1mkrnd4qp77","operationId":"qs4fb6cadhc4otf"}
{"type":"log","timestamp":1692257014780,"level":"debug","message":"(console:log) Before render.....","meta":{"userLevel":true,"rootId":"m1yh1zr8famuwqp","id":"m1yh1zr8famuwqp"},"id":"dzzbjp7z9iwtas7","previousOperationId":"qs4fb6cadhc4otf"}
{"type":"log","timestamp":1692257017117,"level":"debug","message":"(console:log) strstrstr eraId\":\"bb0b0dbf-1822-c68d-7af9-868a39ecc508\",\"name\":\"Kho 4E - 2\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{bb0b0dbf-1822-c68d-7af9-868a39ecc508}.mpjpeg?auth=YWRtaW46NjAyOGE0Mzc4NWQ0MDoyMGMzYzg1NDMzODhmMjc0ZWNlMTI5OGJhODViNjliMQ==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=12&subtype=0\"},{\"cameraId\":\"487c81e7-70ef-b0b4-affa-7189c927f385\",\"name\":\"Thang máy tầng M - 4E\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{487c81e7-70ef-b0b4-affa-7189c927f385}.mpjpeg?auth=YWRtaW46NjAyOGE0MzgzOGM4ODo5MmZjMzM5ZTU5ZDljYTIyMDVkYTEwZmI0MzRkZTJiNw==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=13&subtype=0\"},{\"cameraId\":\"a61a0dbf-fff6-3fdc-43de-55820b14d34b\",\"name\":\"Thang máy tầng 1 - 4E\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{a61a0dbf-fff6-3fdc-43de-55820b14d34b}.mpjpeg?auth=YWRtaW46NjAyOGE0MzgzZDJkODpiOTg5OTgwOWI5NWIwMjg1NTU5YmUxZjc3MDM0NjgzOQ==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=14&subtype=0\"},{\"cameraId\":\"0f3fb31f-7105-1d21-7abb-04c3989b746a\",\"name\":\"Thang máy tầng 2 - 4E\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{0f3fb31f-7105-1d21-7abb-04c3989b746a}.mpjpeg?auth=YWRtaW46NjAyOGE0MzhmOGVjMDphNTE0MzE2ZTA4ZTNlMDBlY2VmZjRhMjU2YTNiMDllZQ==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=15&subtype=0\"},{\"cameraId\":\"fbc03e49-1d73-2fc8-b4db-b14567c0ab3e\",\"name\":\"Thang máy tầng 3 - 4E\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{fbc03e49-1d73-2fc8-b4db-b14567c0ab3e}.mpjpeg?auth=YWRtaW46NjAyOGE0Mzg0MmNiMDpkN2M3OTBkMmM4YzliYjc4ODcwOTdjOGYzNTBlOGNmNQ==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=16&subtype=0\"},{\"cameraId\":\"f32e979e-1958-0a58-8c33-dfa3cd3ec66d\",\"name\":\"Thang máy tầng 4 - 4E\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{f32e979e-1958-0a58-8c33-dfa3cd3ec66d}.mpjpeg?auth=YWRtaW46NjAyOGE0MzkwZTI5ODpkZDM1MmFkZTFhN2VlOTE5Y2ZkMDE4NmNjYjYwYzViMA==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=17&subtype=0\"},{\"cameraId\":\"89aa8062-7bb5-ed4c-c6c2-788bb300d355\",\"name\":\"Thang máy tầng 5 - 4E\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{89aa8062-7bb5-ed4c-c6c2-788bb300d355}.mpjpeg?auth=YWRtaW46NjAyOGE0Mzg0YTFlMDo3NDVkZDI2OGEyMTlkOWY3ZjBhNjI0N2Y0NTkxZDBhNg==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=18&subtype=0\"},{\"cameraId\":\"f8a5750b-a58e-7555-b153-455243dfb4f6\",\"name\":\"Sảnh cafe\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{f8a5750b-a58e-7555-b153-455243dfb4f6}.mpjpeg?auth=YWRtaW46NjAyOGE0MzdkZjZkODo0MTI3Y2Q0OTk4MmI1OGI4MmZkMzkyNzY4MzFjODFmOA==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=19&subtype=0\"},{\"cameraId\":\"36966aa1-bc80-2c11-98f0-dbb2ba77733c\",\"name\":\"Cafe 02\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{36966aa1-bc80-2c11-98f0-dbb2ba77733c}.mpjpeg?auth=YWRtaW46NjAyOGE0Mzg1MzI2ODo3NGM2OWYyMGUwNzgyNDA2OGJmYzExODE3MTQxMjc2MA==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=20&subtype=0\"},{\"cameraId\":\"b1ad766c-febf-9428-815f-f9dc0eb4e76b\",\"name\":\"Thang máy 9A\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{b1ad766c-febf-9428-815f-f9dc0eb4e76b}.mpjpeg?auth=YWRtaW46NjAyOGE0MzgzOTQ1ODpiMjM1MWZhYjRiNWI4MmRkYjA4MmVlY2E4Yzc4NmNlMg==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=21&subtype=0\"},{\"cameraId\":\"090131fe-ac72-59b9-bc6c-514149227ab4\",\"name\":\"Hầm kho 9A - 3\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{090131fe-ac72-59b9-bc6c-514149227ab4}.mpjpeg?auth=YWRtaW46NjAyOGE0Mzc2NWQ4ODpjNGI1MjQ5Nzc0MjljOTFiZGU5MDUxNGQ0MDYyODBjNw==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=22&subtype=0\"},{\"cameraId\":\"71866ce6-9719-af51-eff7-9b8391f001ad\",\"name\":\"Hầm kho 9A - 4\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{71866ce6-9719-af51-eff7-9b8391f001ad}.mpjpeg?auth=YWRtaW46NjAyOGE0MzgzMjZmODpjOGU1ZWVjNmI4Njc5OTEwMzdjODc3YTQxM2JmNTg0NA==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=23&subtype=0\"},{\"cameraId\":\"ce67ef6a-da01-fe25-df8b-a6ad5fc048cd\",\"name\":\"Kế toán\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{ce67ef6a-da01-fe25-df8b-a6ad5fc048cd}.mpjpeg?auth=YWRtaW46NjAyOGE0MzkwYzc0MDo4MDJjMzY2OGQ0MTM0NDg5NjlkMzUxNTk4YzMxYTFkNQ==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=24&subtype=0\"},{\"cameraId\":\"637162e4-90c4-1c0a-1cc6-aa780c78c8a1\",\"name\":\"Server IT\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{637162e4-90c4-1c0a-1cc6-aa780c78c8a1}.mpjpeg?auth=YWRtaW46NjAyOGE0MzgzMzY5ODozZDg5NTg2NGViMDE5YmY3NzU4MzQ3YTMzNDIxNGM3Zg==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=25&subtype=0\"},{\"cameraId\":\"aedc3d8b-007c-e81e-151d-d96893174de1\",\"name\":\"Hầm kho 9A - 2\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{aedc3d8b-007c-e81e-151d-d96893174de1}.mpjpeg?auth=YWRtaW46NjAyOGE0Mzg0ODY4ODo4Nzc4Y2RiNjY4MDBjYmRkYmJmY2M2MWMxNmI0NDdjNg==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=26&subtype=0\"},{\"cameraId\":\"af3aa61c-60be-8b64-1632-a7ad9552bcfc\",\"name\":\"Kho 4E - 3\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{af3aa61c-60be-8b64-1632-a7ad9552bcfc}.mpjpeg?auth=YWRtaW46NjAyOGE0Mzc2MjZkODpjMGQ1OTdiOWY4Yzg0NmE5NmJmOTFjMmFmZjgzMzkwZQ==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=27&subtype=0\"},{\"cameraId\":\"d766f17a-8f5a-2ee7-d061-55e386c5880f\",\"name\":\"Hầm kho 9A - 1\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{d766f17a-8f5a-2ee7-d061-55e386c5880f}.mpjpeg?auth=YWRtaW46NjAyOGE0MzgzOTA3MDozZDBmMTRjMWQ0YjIwMDBhNjdkNGUxYTc1YzQ4NjNkOQ==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=28&subtype=0\"},{\"cameraId\":\"91e1ccf8-6c6a-be9d-0035-2da77130a2cb\",\"name\":\"Sảnh 9A\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{91e1ccf8-6c6a-be9d-0035-2da77130a2cb}.mpjpeg?auth=YWRtaW46NjAyOGE0Mzg2MThlMDpkOWI4ODZkOWI5M2VlOGYyZjIzNDI3NDQ2OThhNzlhYQ==&rt\",\"rawRtsp\":\"rtsp://vietan:vietan$123@101.53.43.148:554/cam/realmonitor?channel=29&subtype=0\"},{\"cameraId\":\"237d2cfc-a7c3-22ee-2847-3655ff07e29f\",\"name\":\"Cầu thang\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{237d2cfc-a7c3-22ee-2847-3655ff07e29f}.mpjpeg?auth=YWRtaW46NjAyOGE0NTdjNWVlODphNDg1NTBmNmQ2Nzc1NjYwZTM4MmUxMWJiMDE5MzczMw==&rt\",\"rawRtsp\":\"rtsp://admin:L2F11989@113.23.36.76:1554/cam/realmonitor?channel=1&subtype=0&unicast=true&proto=Onvif\"},{\"cameraId\":\"02850145-4177-6514-7d4a-7562da2aac38\",\"name\":\"Nhà xe\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{02850145-4177-6514-7d4a-7562da2aac38}.mpjpeg?auth=YWRtaW46NjAyOGE0NTgyYTA3ODoyM2ZhOWEwZjRjMzQyY2U3YjYzODQxYWM4NWVjMjRlZA==&rt\",\"rawRtsp\":\"rtsp://admin:L2B207A0@113.23.36.76:2554/cam/realmonitor?channel=1&subtype=0&unicast=true&proto=Onvif\"},{\"cameraId\":\"55705a59-8aa7-71d4-ff53-f27d110ffc21\",\"name\":\"Kho\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{55705a59-8aa7-71d4-ff53-f27d110ffc21}.mpjpeg?auth=YWRtaW46NjAyOGE0NTgzMzEwMDo0NDMwNzBkNDVjZjdkNDA2MDYwYzQ1OTJjZjRmZmNjNg==&rt\",\"rawRtsp\":\"rtsp://admin:L252DB78@113.23.36.76:3554/cam/realmonitor?channel=1&subtype=0&unicast=true&proto=Onvif\"},{\"cameraId\":\"ad1cde55-6162-9952-7ced-434b87b60d74\",\"name\":\"Trước nhà\",\"rtspUrl\":\"https://dev-camera.ilotusland.asia/media/{ad1cde55-6162-9952-7ced-434b87b60d74}.mpjpeg?auth=YWRtaW46NjAyOGE0MzgzMmVjODphOTU5MmQwZTA3NjVjMzFhNmM1MzRhZDYwOGQ3OGZkNQ==&rt\",\"rawRtsp\":\"rtsp://admin:L217CBBB@113.23.36.76:4554/cam/realmonitor?channel=1&subtype=0&unicast=true&proto=Onvif\"}],\"allowed\":true}},\"standardsVN\":null,\"connection\":{\"connectionId\":\"40aff972-429b-4965-9546-e39ab335080f\"},\"lastLog\":{},\"lastLogMeasureAdvanced\":{}}],\"success\":true}","meta":{"userLevel":true,"rootId":"m1yh1zr8famuwqp","id":"m1yh1zr8famuwqp"},"id":"96mkwbdcyjvhigz","previousOperationId":"qs4fb6cadhc4otf"}
{"type":"log","timestamp":1692257017132,"level":"warn","message":"Error when processing render request 3\n(because) error when evaluating custom script /ill-script\nUnexpected token e in JSON at position 0\n\n(sandbox.js line 27:39)\n\n  25 |                 try {\n  26 |                     console.log(\"strstrstr\",str)\n> 27 |                     const data = JSON.parse(str).value;\n     |                                       ^\n  28 |                     resolve(data);\n  29 |                 } catch (error) {\n  30 |                     reject(error);\n\n\nSyntaxError: Unexpected token e in JSON at position 0\n    at JSON.parse (<anonymous>)\n    at IncomingMessage.<anonymous> (sandbox.js:27:39)\n    at IncomingMessage.emit (node:events:525:35)\n    at IncomingMessage.emit (node:domain:552:15)\n    at endReadableNT (node:internal/streams/readable:1359:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","meta":{"rootId":"m1yh1zr8famuwqp","id":"m1yh1zr8famuwqp"},"id":"v7qz04hwsb955cl","previousOperationId":"qs4fb6cadhc4otf"}
{"type":"log","timestamp":1692257017132,"level":"warn","message":"Rendering request 3 finished with error in 2665 ms","meta":{"rootId":"m1yh1zr8famuwqp","id":"m1yh1zr8famuwqp"},"id":"n6stafp6ayk4ta8","previousOperationId":"qs4fb6cadhc4otf"}
{"type":"error","timestamp":1692257017258,"statusCode":400,"weak":true,"decoratedSuffix":"\n\n(sandbox.js line 27:39)\n\n  25 |                 try {\n  26 |                     console.log(\"strstrstr\",str)\n> 27 |                     const data = JSON.parse(str).value;\n     |                                       ^\n  28 |                     resolve(data);\n  29 |                 } catch (error) {\n  30 |                     reject(error);\n\n","entity":{"shortid":"vivaZZXxUu","name":"ill-script","content":"// server side script fetching remote data and preparing report data source\nconst https = require('https');\n\nconst END_POINT = 'https://demo-api.ilotusland.asia/station-auto/last-log';\nconst CUSTOM_HEADER = {\n    'Authorization': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDE5MGI3ZWZjMzgzMDAwMWJmMTAxNWUiLCJmaXJzdE5hbWUiOiJNaW5oIiwibGFzdE5hbWUiOiLEkOG7lyIsImlzQWRtaW4iOnRydWUsImlzQWN0aXZlIjpmYWxzZSwiaXNPd25lciI6dHJ1ZSwib3JnYW5pemF0aW9uIjp7Il9pZCI6IjVlZWY4MDExOWQ0ZjQ1MDAxMWMzMGQ1OSIsIm5hbWUiOiJpTG90dXNMYW5kIFZpZXQgTmFtIEpTQy4ifSwiaWF0IjoxNjkwOTU3OTk0fQ.x2abIiIwQf8tXlqYIUZ2EUdw9sIwwt1TG7ZE-hxs7Eo',\n};\n\nfunction fetchData() {\n    return new Promise((resolve, reject) => {\n        const options = {\n            headers: CUSTOM_HEADER\n        };\n\n        https.get(END_POINT, options, (result) => {\n            var str = '';\n\n            result.on('data', (b) => {\n                str = b.toString(); // Convert the received data chunk to a string\n            });\n\n            result.on('error', reject);\n\n            result.on('end', () => {\n                try {\n                    console.log(\"strstrstr\",str)\n                    const data = JSON.parse(str).value;\n                    resolve(data);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        });\n\n    });\n}\n\nconst prepareData = async() => {\n    const data = await fetchData()\n    let stations = data.data\n    stations = stations.map(station => {\n        return {\n            name: station.name,\n            data: station.lastlog.measuringLogs\n        }\n    })\n    console.log(stations,'stationsstations')\n    return stations\n}\n\n\nasync function beforeRender(req, res) {\n    console.log(\"Before render.....\")\n    req.stations = await prepareData()\n}"},"property":"content","logged":true,"previousOperationId":"qs4fb6cadhc4otf","id":"7pi04yl5jbnbn39","stack":"SyntaxError: Unexpected token e in JSON at position 0\n    at JSON.parse (<anonymous>)\n    at IncomingMessage.<anonymous> (sandbox.js:27:39)\n    at IncomingMessage.emit (node:events:525:35)\n    at IncomingMessage.emit (node:domain:552:15)\n    at endReadableNT (node:internal/streams/readable:1359:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","message":"Error when evaluating custom script /ill-script\nUnexpected token e in JSON at position 0\n\n(sandbox.js line 27:39)\n\n  25 |                 try {\n  26 |                     console.log(\"strstrstr\",str)\n> 27 |                     const data = JSON.parse(str).value;\n     |                                       ^\n  28 |                     resolve(data);\n  29 |                 } catch (error) {\n  30 |                     reject(error);\n\n"}
