{"type":"operationStart","subtype":"profile","data":{"_id":"30fvbLjFI9st0OTD","timestamp":"2023-08-17T07:36:41.204Z","state":"queued","mode":"standard","creationDate":"2023-08-17T07:36:41.214Z","modificationDate":"2023-08-17T07:36:41.214Z","shortid":"iJKIVML","$entitySet":"profiles"},"doDiffs":false,"timestamp":1692257801213,"id":"6kauhqcm3pz1lw1","previousOperationId":null,"operationId":"3q3dkmrkewz3uwg"}
{"type":"log","level":"info","message":"Render request 10 queued for execution and waiting for available worker","previousOperationId":"3q3dkmrkewz3uwg","timestamp":1692257801213,"id":"pkmhheol44l1cqa"}
{"type":"operationStart","subtype":"render","name":"iLotusLand report","previousOperationId":"3q3dkmrkewz3uwg","timestamp":1692257801238,"id":"q43vg3hwe3vonkn","previousEventId":"6kauhqcm3pz1lw1","operationId":"nomn7bs5k2i1dig"}
{"type":"log","timestamp":1692257801240,"level":"info","message":"Starting rendering request 10","meta":{"rootId":"7jl9rlcuobeqkc7","id":"7jl9rlcuobeqkc7"},"id":"vqzenjqaytyzuwp","previousOperationId":"nomn7bs5k2i1dig"}
{"type":"log","timestamp":1692257801241,"level":"info","message":"Rendering template { name: iLotusLand report, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"7jl9rlcuobeqkc7","id":"7jl9rlcuobeqkc7"},"id":"jcyabmbicmv2kc2","previousOperationId":"nomn7bs5k2i1dig"}
{"type":"log","timestamp":1692257801242,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"7jl9rlcuobeqkc7","id":"7jl9rlcuobeqkc7"},"id":"ajtadj3noanglwy","previousOperationId":"nomn7bs5k2i1dig"}
{"type":"log","timestamp":1692257801249,"level":"debug","message":"Executing script ill-script (beforeRender)","meta":{"rootId":"7jl9rlcuobeqkc7","id":"7jl9rlcuobeqkc7"},"id":"it3hq2cubl4amu5","previousOperationId":"nomn7bs5k2i1dig"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1692257801283,"id":"0ol7w1viix5g8ux","previousEventId":"q43vg3hwe3vonkn","operationId":"pfjdqyt305t76wm","previousOperationId":"nomn7bs5k2i1dig"}
{"type":"operationStart","subtype":"script","name":"scripts ill-script","previousOperationId":"pfjdqyt305t76wm","timestamp":1692257801283,"id":"b728l3lv3pnoaza","previousEventId":"0ol7w1viix5g8ux","operationId":"th4fi7247opscwg"}
{"type":"log","timestamp":1692257801284,"level":"debug","message":"(console:log) Before render.....","meta":{"userLevel":true,"rootId":"7jl9rlcuobeqkc7","id":"7jl9rlcuobeqkc7"},"id":"ghga0pexjzat9w3","previousOperationId":"th4fi7247opscwg"}
{"type":"log","timestamp":1692257802530,"level":"debug","message":"(console:log) HEllo station [object Object]","meta":{"userLevel":true,"rootId":"7jl9rlcuobeqkc7","id":"7jl9rlcuobeqkc7"},"id":"4gxwp9x74puszbz","previousOperationId":"th4fi7247opscwg"}
{"type":"log","timestamp":1692257802547,"level":"warn","message":"Error when processing render request 10\n(because) error when evaluating custom script /ill-script\nCannot read properties of undefined (reading 'measuringLogs')\n\n(sandbox.js line 45:35)\n\n  43 |         return {\n  44 |             name: station.name,\n> 45 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  46 |         }\n  47 |     })\n  48 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 42:25)\n\n  40 |     console.log(\"HEllo station \"+data)\n  41 |     let stations = data.data\n> 42 |     stations = stations.map(station => {\n     |                         ^\n  43 |         return {\n  44 |             name: station.name,\n  45 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 55:20)\n\n  53 | async function beforeRender(req, res) {\n  54 |     console.log(\"Before render.....\")\n> 55 |     req.stations = await prepareData()\n     |                    ^\n  56 | }\n\n\nTypeError: Cannot read properties of undefined (reading 'measuringLogs')\n    at sandbox.js:45:35\n    at Array.map (<anonymous>)\n    at prepareData (sandbox.js:42:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Object.beforeRender (sandbox.js:55:20)\n    at async executionFn (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:67:11)\n    at async run (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:152:24)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:182:14)\n    at async executeScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:122:12)\n    at async Scripts._runScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/worker.js:140:30)","meta":{"rootId":"7jl9rlcuobeqkc7","id":"7jl9rlcuobeqkc7"},"id":"bgdpnroueig0l07","previousOperationId":"th4fi7247opscwg"}
{"type":"log","timestamp":1692257802552,"level":"warn","message":"Rendering request 10 finished with error in 1347 ms","meta":{"rootId":"7jl9rlcuobeqkc7","id":"7jl9rlcuobeqkc7"},"id":"9rz6czz7utflnrj","previousOperationId":"th4fi7247opscwg"}
{"type":"error","timestamp":1692257802611,"statusCode":400,"weak":true,"lineNumber":45,"decoratedSuffix":"\n\n(sandbox.js line 45:35)\n\n  43 |         return {\n  44 |             name: station.name,\n> 45 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  46 |         }\n  47 |     })\n  48 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 42:25)\n\n  40 |     console.log(\"HEllo station \"+data)\n  41 |     let stations = data.data\n> 42 |     stations = stations.map(station => {\n     |                         ^\n  43 |         return {\n  44 |             name: station.name,\n  45 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 55:20)\n\n  53 | async function beforeRender(req, res) {\n  54 |     console.log(\"Before render.....\")\n> 55 |     req.stations = await prepareData()\n     |                    ^\n  56 | }\n\n","entity":{"shortid":"vivaZZXxUu","name":"ill-script","content":"// server side script fetching remote data and preparing report data source\nconst https = require('https');\n\nconst END_POINT = 'https://demo-api.ilotusland.asia/station-auto/last-log';\nconst CUSTOM_HEADER = {\n    'Authorization': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDE5MGI3ZWZjMzgzMDAwMWJmMTAxNWUiLCJmaXJzdE5hbWUiOiJNaW5oIiwibGFzdE5hbWUiOiLEkOG7lyIsImlzQWRtaW4iOnRydWUsImlzQWN0aXZlIjpmYWxzZSwiaXNPd25lciI6dHJ1ZSwib3JnYW5pemF0aW9uIjp7Il9pZCI6IjVlZWY4MDExOWQ0ZjQ1MDAxMWMzMGQ1OSIsIm5hbWUiOiJpTG90dXNMYW5kIFZpZXQgTmFtIEpTQy4ifSwiaWF0IjoxNjkwOTU3OTk0fQ.x2abIiIwQf8tXlqYIUZ2EUdw9sIwwt1TG7ZE-hxs7Eo',\n};\n\nfunction fetchData() {\n    return new Promise((resolve, reject) => {\n        const options = {\n            headers: CUSTOM_HEADER\n        };\n\n        https.get(END_POINT, options, (result) => {\n            let data = '';\n\n            result.on('data', (chunk) => {\n                data +=chunk; // Convert the received data chunk to a string\n            });\n\n            result.on('error', reject);\n\n            result.on('end', () => {\n                try {\n                    // console.log(\"strstrstr\",data)\n                    const result = JSON.parse(data);\n                    resolve(result);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        });\n\n    });\n}\n\nconst prepareData = async() => {\n    const data = await fetchData()\n    console.log(\"HEllo station \"+data)\n    let stations = data.data\n    stations = stations.map(station => {\n        return {\n            name: station.name,\n            data: station.lastlog.measuringLogs\n        }\n    })\n    console.log(stations,'stationsstations')\n    return stations\n}\n\n\nasync function beforeRender(req, res) {\n    console.log(\"Before render.....\")\n    req.stations = await prepareData()\n}"},"property":"content","logged":true,"previousOperationId":"th4fi7247opscwg","id":"bjq3ofjobgcbxjb","stack":"TypeError: Cannot read properties of undefined (reading 'measuringLogs')\n    at sandbox.js:45:35\n    at Array.map (<anonymous>)\n    at prepareData (sandbox.js:42:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Object.beforeRender (sandbox.js:55:20)\n    at async executionFn (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:67:11)\n    at async run (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:152:24)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:182:14)\n    at async executeScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:122:12)\n    at async Scripts._runScript (/Users/admin/Desktop/research/jsreport/node_modules/@jsreport/jsreport-scripts/lib/worker.js:140:30)","message":"Error when evaluating custom script /ill-script\nCannot read properties of undefined (reading 'measuringLogs')\n\n(sandbox.js line 45:35)\n\n  43 |         return {\n  44 |             name: station.name,\n> 45 |             data: station.lastlog.measuringLogs\n     |                                   ^\n  46 |         }\n  47 |     })\n  48 |     console.log(stations,'stationsstations')\n\n(sandbox.js line 42:25)\n\n  40 |     console.log(\"HEllo station \"+data)\n  41 |     let stations = data.data\n> 42 |     stations = stations.map(station => {\n     |                         ^\n  43 |         return {\n  44 |             name: station.name,\n  45 |             data: station.lastlog.measuringLogs\n\n(sandbox.js line 55:20)\n\n  53 | async function beforeRender(req, res) {\n  54 |     console.log(\"Before render.....\")\n> 55 |     req.stations = await prepareData()\n     |                    ^\n  56 | }\n\n"}
